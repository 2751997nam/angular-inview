<!DOCTYPE html>

<html>
<head>
  <title>Angular-Inview</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="angular-inview">Angular-Inview</h1>
<ul>
<li>Author: <a href="https://github.com/thenikso">Nicola Peduzzi</a></li>
<li>Repository: <a href="https://github.com/thenikso/angular-inview">https://github.com/thenikso/angular-inview</a></li>
<li>Install with: <code>npm install angular-inview@beta</code></li>
<li>Version: <strong>2.3.1</strong></li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">'use strict'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>An <a href="https://angularjs.org">angular.js</a> directive to evaluate an expression if
a DOM element is or not in the current visible browser viewport.
Use it in your AngularJS app by including the javascript and requireing it:</p>
<p><code>angular.module(&#39;myApp&#39;, [&#39;angular-inview&#39;])</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> moduleName = <span class="hljs-string">'angular-inview'</span>;
angular.module(moduleName, [])</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="in-view-directive">in-view directive</h2>
<h3 id="usage">Usage</h3>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">any</span> <span class="hljs-attr">in-view</span>=<span class="hljs-string">"{expression}"</span> [<span class="hljs-attr">in-view-options</span>=<span class="hljs-string">"{object}"</span>]&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">any</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>.directive(<span class="hljs-string">'inView'</span>, [<span class="hljs-string">'$parse'</span>, inViewDirective])</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2 id="in-view-container-directive">in-view-container directive</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>.directive(<span class="hljs-string">'inViewContainer'</span>, inViewContainerDirective);</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2 id="implementation">Implementation</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inViewDirective</span> (<span class="hljs-params">$parse</span>) </span>{
  <span class="hljs-keyword">return</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Evaluate the expression passet to the attribute <code>in-view</code> when the DOM
element is visible in the viewport.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    restrict: <span class="hljs-string">'A'</span>,
    <span class="hljs-attr">require</span>: <span class="hljs-string">'?^^inViewContainer'</span>,
    <span class="hljs-attr">link</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inViewDirectiveLink</span> (<span class="hljs-params">scope, element, attrs, container</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>in-view-options attribute can be specified with an object expression
containing:</p>
<ul>
<li><code>offset</code>: An array of values to offset the element position.
Offsets are expressed as arrays of 4 numbers [top, right, bottom, left].
Like CSS, you can also specify only 2 numbers [top/bottom, left/right].
Instead of numbers, some array elements can be a string with a percentage.
Positive numbers are offsets outside the element rectangle and
negative numbers are offsets to the inside.</li>
<li><code>viewportOffset</code>: Like the element offset but appied to the viewport.</li>
<li><code>generateDirection</code>: Indicate if the <code>direction</code> information should
be included in <code>$inviewInfo</code> (default false).</li>
<li><code>generateParts</code>: Indicate if the <code>parts</code> information should
be included in <code>$inviewInfo</code> (default false).</li>
<li><code>throttle</code>: Specify a number of milliseconds by which to limit the
number of incoming events.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> options = {};
      <span class="hljs-keyword">if</span> (attrs.inViewOptions) {
        options = scope.$<span class="hljs-built_in">eval</span>(attrs.inViewOptions);
      }
      <span class="hljs-keyword">if</span> (options.offset) {
        options.offset = normalizeOffset(options.offset);
      }
      <span class="hljs-keyword">if</span> (options.viewportOffset) {
        options.viewportOffset = normalizeOffset(options.viewportOffset);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Build reactive chain from an initial event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> viewportEventSignal = signalSingle({ <span class="hljs-attr">type</span>: <span class="hljs-string">'initial'</span> })</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Merged with the window events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      .merge(signalFromEvent(<span class="hljs-built_in">window</span>, <span class="hljs-string">'checkInView click ready wheel mousewheel DomMouseScroll MozMousePixelScroll resize scroll touchmove mouseup keydown'</span>))</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Merge with containerâ€™s events signal</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (container) {
        viewportEventSignal = viewportEventSignal.merge(container.eventsSignal);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Throttle if option specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (options.throttle) {
        viewportEventSignal = viewportEventSignal.throttle(options.throttle);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Map to viewport intersection and in-view informations</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> inviewInfoSignal = viewportEventSignal</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Inview information structure contains:</p>
<ul>
<li><code>inView</code>: a boolean value indicating if the element is
visible in the viewport;</li>
<li><code>changed</code>: a boolean value indicating if the inview status
changed after the last event;</li>
<li><code>event</code>: the event that initiated the in-view check;</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>      .map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> viewportRect;
        <span class="hljs-keyword">if</span> (container) {
          viewportRect = container.getViewportRect();</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>TODO merge with actual window!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        } <span class="hljs-keyword">else</span> {
          viewportRect = getViewportRect();
        }
        viewportRect = offsetRect(viewportRect, options.viewportOffset);
        <span class="hljs-keyword">var</span> elementRect = offsetRect(element[<span class="hljs-number">0</span>].getBoundingClientRect(), options.offset);
        <span class="hljs-keyword">var</span> info = {
          <span class="hljs-attr">inView</span>: intersectRect(elementRect, viewportRect),
          <span class="hljs-attr">event</span>: event,
          <span class="hljs-attr">element</span>: element,
          <span class="hljs-attr">elementRect</span>: elementRect,
          <span class="hljs-attr">viewportRect</span>: viewportRect
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Add inview parts</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (options.generateParts &amp;&amp; info.inView) {
          info.parts = {};
          info.parts.top = elementRect.top &gt;= viewportRect.top;
          info.parts.left = elementRect.left &gt;= viewportRect.left;
          info.parts.bottom = elementRect.bottom &lt;= viewportRect.bottom;
          info.parts.right = elementRect.right &lt;= viewportRect.right;
        }
        <span class="hljs-keyword">return</span> info;
      })</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Add the changed information to the inview structure.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      .scan({}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">lastInfo, newInfo</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Add inview direction info</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (options.generateDirection &amp;&amp; newInfo.inView &amp;&amp; lastInfo.elementRect) {
          newInfo.direction = {
            <span class="hljs-attr">horizontal</span>: newInfo.elementRect.left - lastInfo.elementRect.left,
            <span class="hljs-attr">vertical</span>: newInfo.elementRect.top - lastInfo.elementRect.top
          };
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Calculate changed flag</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        newInfo.changed =
          newInfo.inView !== lastInfo.inView ||
          !angular.equals(newInfo.parts, lastInfo.parts) ||
          !angular.equals(newInfo.direction, lastInfo.direction);
        <span class="hljs-keyword">return</span> newInfo;
      })</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Filters only informations that should be forwarded to the callback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      .filter(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">info</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Donâ€™t forward if no relevant infomation changed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (!info.changed) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Donâ€™t forward if not initially in-view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (info.event.type === <span class="hljs-string">'initial'</span> &amp;&amp; !info.inView) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Execute in-view callback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> inViewExpression = $parse(attrs.inView);
      <span class="hljs-keyword">var</span> dispose = inviewInfoSignal.subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">info</span>) </span>{
        scope.$applyAsync(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
          inViewExpression(scope, {
            <span class="hljs-string">'$inview'</span>: info.inView,
            <span class="hljs-string">'$inviewInfo'</span>: info
          });
        });
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Dispose of reactive chain</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      scope.$on(<span class="hljs-string">'$destroy'</span>, dispose);
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inViewContainerDirective</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">restrict</span>: <span class="hljs-string">'A'</span>,
    <span class="hljs-attr">controller</span>: [<span class="hljs-string">'$element'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$element</span>) </span>{
      <span class="hljs-keyword">this</span>.element = $element;
      <span class="hljs-keyword">this</span>.eventsSignal = signalFromEvent($element, <span class="hljs-string">'scroll'</span>);
      <span class="hljs-keyword">this</span>.getViewportRect = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> $element[<span class="hljs-number">0</span>].getBoundingClientRect();
      };
    }]
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <h2 id="utilities">Utilities</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getViewportRect</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> result = {
    <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">left</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">width</span>: <span class="hljs-built_in">window</span>.innerWidth,
    <span class="hljs-attr">right</span>: <span class="hljs-built_in">window</span>.innerWidth,
    <span class="hljs-attr">height</span>: <span class="hljs-built_in">window</span>.innerHeight,
    <span class="hljs-attr">bottom</span>: <span class="hljs-built_in">window</span>.innerHeight
  };
  <span class="hljs-keyword">if</span> (result.height) {
    <span class="hljs-keyword">return</span> result;
  }
  <span class="hljs-keyword">var</span> mode = <span class="hljs-built_in">document</span>.compatMode;
  <span class="hljs-keyword">if</span> (mode === <span class="hljs-string">'CSS1Compat'</span>) {
    result.width = result.right = <span class="hljs-built_in">document</span>.documentElement.clientWidth;
    result.height = result.bottom = <span class="hljs-built_in">document</span>.documentElement.clientHeight;
  } <span class="hljs-keyword">else</span> {
    result.width = result.right = <span class="hljs-built_in">document</span>.body.clientWidth;
    result.height = result.bottom = <span class="hljs-built_in">document</span>.body.clientHeight;
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">intersectRect</span> (<span class="hljs-params">r1, r2</span>) </span>{
  <span class="hljs-keyword">return</span> !(r2.left &gt; r1.right ||
           r2.right &lt; r1.left ||
           r2.top &gt; r1.bottom ||
           r2.bottom &lt; r1.top);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">normalizeOffset</span> (<span class="hljs-params">offset</span>) </span>{
  <span class="hljs-keyword">if</span> (!angular.isArray(offset)) {
    <span class="hljs-keyword">return</span> [offset, offset, offset, offset];
  }
  <span class="hljs-keyword">if</span> (offset.length == <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">return</span> offset.concat(offset);
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (offset.length == <span class="hljs-number">3</span>) {
    <span class="hljs-keyword">return</span> offset.concat([offset[<span class="hljs-number">1</span>]]);
  }
  <span class="hljs-keyword">return</span> offset;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">offsetRect</span> (<span class="hljs-params">rect, offset</span>) </span>{
  <span class="hljs-keyword">if</span> (!offset) {
    <span class="hljs-keyword">return</span> rect;
  }
  <span class="hljs-keyword">var</span> offsetObject = {
    <span class="hljs-attr">top</span>: isPercent(offset[<span class="hljs-number">0</span>]) ? (<span class="hljs-built_in">parseFloat</span>(offset[<span class="hljs-number">0</span>]) * rect.height) : offset[<span class="hljs-number">0</span>],
    <span class="hljs-attr">right</span>: isPercent(offset[<span class="hljs-number">1</span>]) ? (<span class="hljs-built_in">parseFloat</span>(offset[<span class="hljs-number">1</span>]) * rect.width) : offset[<span class="hljs-number">1</span>],
    <span class="hljs-attr">bottom</span>: isPercent(offset[<span class="hljs-number">2</span>]) ? (<span class="hljs-built_in">parseFloat</span>(offset[<span class="hljs-number">2</span>]) * rect.height) : offset[<span class="hljs-number">2</span>],
    <span class="hljs-attr">left</span>: isPercent(offset[<span class="hljs-number">3</span>]) ? (<span class="hljs-built_in">parseFloat</span>(offset[<span class="hljs-number">3</span>]) * rect.width) : offset[<span class="hljs-number">3</span>]
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Note: ClientRect object does not allow its properties to be written to therefore a new object has to be created.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">top</span>: rect.top - offsetObject.top,
    <span class="hljs-attr">left</span>: rect.left - offsetObject.left,
    <span class="hljs-attr">bottom</span>: rect.bottom + offsetObject.bottom,
    <span class="hljs-attr">right</span>: rect.right + offsetObject.right,
    <span class="hljs-attr">height</span>: rect.height + offsetObject.top + offsetObject.bottom,
    <span class="hljs-attr">width</span>: rect.width + offsetObject.left + offsetObject.right
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isPercent</span> (<span class="hljs-params">n</span>) </span>{
  <span class="hljs-keyword">return</span> angular.isString(n) &amp;&amp; n.indexOf(<span class="hljs-string">'%'</span>) &gt; <span class="hljs-number">0</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <h2 id="quicksignal-frp">QuickSignal FRP</h2>
<p>A quick and dirty implementation of Rx to have a streamlined code in the
directives.</p>

            </div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <h3 id="quicksignal">QuickSignal</h3>
<ul>
<li><code>didSubscribeFunc</code>: a function receiving a <code>subscriber</code> as described below</li>
</ul>
<p>Usage:
    var mySignal = new QuickSignal(function(subscriber) { â€¦ })</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">QuickSignal</span> (<span class="hljs-params">didSubscribeFunc</span>) </span>{
  <span class="hljs-keyword">this</span>.didSubscribeFunc = didSubscribeFunc;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Subscribe to a signal and consume the steam of data.</p>
<p>Returns a function that can be called to stop the signal stream of data and
perform cleanup.</p>
<p>A <code>subscriber</code> is a function that will be called when a new value arrives.
a <code>subscriber.$dispose</code> property can be set to a function to be called uppon
disposal. When setting the <code>$dispose</code> function, the previously set function
should be chained.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>QuickSignal.prototype.subscribe = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subscriber</span>) </span>{
  <span class="hljs-keyword">this</span>.didSubscribeFunc(subscriber);
  <span class="hljs-keyword">var</span> dispose = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (subscriber.$dispose) {
      subscriber.$dispose();
      subscriber.$dispose = <span class="hljs-literal">null</span>;
    }
  }
  <span class="hljs-keyword">return</span> dispose;
}

QuickSignal.prototype.map = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">f</span>) </span>{
  <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QuickSignal(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subscriber</span>) </span>{
    subscriber.$dispose = s.subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">nextValue</span>) </span>{
      subscriber(f(nextValue));
    });
  });
};

QuickSignal.prototype.filter = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">f</span>) </span>{
  <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QuickSignal(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subscriber</span>) </span>{
    subscriber.$dispose = s.subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">nextValue</span>) </span>{
      <span class="hljs-keyword">if</span> (f(nextValue)) {
        subscriber(nextValue);
      }
    });
  });
};

QuickSignal.prototype.scan = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">initial, scanFunc</span>) </span>{
  <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QuickSignal(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subscriber</span>) </span>{
    <span class="hljs-keyword">var</span> last = initial;
    subscriber.$dispose = s.subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">nextValue</span>) </span>{
      last = scanFunc(last, nextValue);
      subscriber(last);
    });
  });
}

QuickSignal.prototype.merge = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">signal</span>) </span>{
  <span class="hljs-keyword">return</span> signalMerge(<span class="hljs-keyword">this</span>, signal);
};

QuickSignal.prototype.throttle = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">threshhold</span>) </span>{
  <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>, last, deferTimer;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QuickSignal(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subscriber</span>) </span>{
    <span class="hljs-keyword">var</span> chainDisposable = s.subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> now = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>,
          args = <span class="hljs-built_in">arguments</span>;
      <span class="hljs-keyword">if</span> (last &amp;&amp; now &lt; last + threshhold) {
        clearTimeout(deferTimer);
        deferTimer = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
          last = now;
          subscriber.apply(<span class="hljs-literal">null</span>, args);
        }, threshhold);
      } <span class="hljs-keyword">else</span> {
        last = now;
        subscriber.apply(<span class="hljs-literal">null</span>, args);
      }
    });
    subscriber.$dispose = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      clearTimeout(deferTimer);
      <span class="hljs-keyword">if</span> (chainDisposable) chainDisposable();
    };
  });
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">signalMerge</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> signals = <span class="hljs-built_in">arguments</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QuickSignal(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subscriber</span>) </span>{
    <span class="hljs-keyword">var</span> disposables = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = signals.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
      disposables.push(signals[i].subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        subscriber.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>);
      }));
    }
    subscriber.$dispose = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = disposables.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
        <span class="hljs-keyword">if</span> (disposables[i]) disposables[i]();
      }
    }
  });
}</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Returns a signal from DOM events of a target.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">signalFromEvent</span> (<span class="hljs-params">target, event</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QuickSignal(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subscriber</span>) </span>{
    <span class="hljs-keyword">var</span> handler = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
      subscriber(e);
    };
    <span class="hljs-keyword">var</span> el = angular.element(target);
    el.on(event, handler);
    subscriber.$dispose = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      el.off(event, handler);
    };
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">signalSingle</span> (<span class="hljs-params">value</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QuickSignal(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subscriber</span>) </span>{
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ subscriber(value); });
  });
}</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Module loaders exports</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
  define([<span class="hljs-string">'angular'</span>], moduleName);
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">module</span> &amp;&amp; <span class="hljs-built_in">module</span>.exports) {
  <span class="hljs-built_in">module</span>.exports = moduleName;
}

})();</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
